<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
 
	<!-- ***********************************************************************
	Appender section - use the appenders to control at runtime how the
	messages are formatted and where they are reported.
	**************************************************************************-->
	<appender name="CONSOLE" class="org.apache.log4j.ConsoleAppender">
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d %5p %c %m%n"/>
		</layout>
	</appender>
	
	<appender name="CS-EXCEPTIONS" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/mapmanager/cs-exceptions.log"/>
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d: %5p %m%n"/>
		</layout>
	</appender>

	<appender name="CS-AUDITLOG" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/mapmanager/cs-audit.log"/>
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="date=[%d{yyyy-MM-dd HH:mm:ss}],level=[%p],%m%n"/>
		</layout>
	</appender>

    <appender name="CS-JOB" class="org.apache.log4j.DailyRollingFileAppender">
        <param name="File" value="<%= @logpath %>/mapmanager/cs-job.log"/>
        <param name="DatePattern" value="'.'yyyy-MM-dd"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="date=[%d{yyyy-MM-dd HH:mm:ss}],level=[%p],%m%n"/>
        </layout>
    </appender>

	<appender name="CS-SECURITYLOG" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/mapmanager/cs-security.log"/>
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="date=[%d{yyyy-MM-dd HH:mm:ss}],level=[%p],%m%n"/>
		</layout>
	</appender>

	<appender name="ERROR" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/mapmanager/error.log" />
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<param name="Threshold" value="ERROR"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d: %5p %m%n"/>
		</layout>
	</appender>

	<appender name="EXCEPTIONS" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/mapmanager/exceptions.log" />
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<param name="Threshold" value="WARN"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d %5p - %m%n"/>
		</layout>
	</appender>
	
	<appender name="PUBLICATION_MESSAGES" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/mapmanager/publication_messages.log" />
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
			<param name="Threshold" value="WARN"/>
			<layout class="org.apache.log4j.PatternLayout">
				<param name="ConversionPattern" value="%d %5p - %m%n"/>
			</layout>
	</appender>

	<appender name="DEBUG" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/mapmanager/javascript.log" />
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<param name="Threshold" value="DEBUG"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d: %5p %m%n"/>
		</layout>
	</appender>
	
	<appender name="AUDIT" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/mapmanager/audit.log" />
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<param name="Threshold" value="INFO"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d: %5p %m%n"/>
		</layout>
	</appender>

	<!-- START: LOG4J Appender for windows event log
	<appender name="HPOV" class="com.oyster.mom.logging.EventLogAppender">
		<param name="source" value="MAP"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%m%n"/>
		</layout>
	</appender>
	END: LOG4J Appender for windows event log -->

	<appender name="USERBATCHLOG-DISPLAY" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/user/user-display.log"/>
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d|%m%n"/>
		</layout>
		<filter class="org.apache.log4j.varia.LevelRangeFilter">
			<param name="LevelMin" value="USER_LOGIN#com.oyster.mom.aspect.logging.level.audit.UserLoginLevel" />
			<param name="LevelMax" value="USER_LOGIN#com.oyster.mom.aspect.logging.level.audit.UserLoginLevel" />
			<param name="AcceptOnMatch" value="true" />
		</filter>
	</appender>

	<appender name="ADMINBATCHLOG-DISPLAY" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/admin/admin-display.log"/>
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d|%m**EOL*%n"/>
		</layout>
		<filter class="org.apache.log4j.varia.LevelRangeFilter">
			<param name="LevelMin" value="ADMIN_NOTE#com.oyster.mom.aspect.logging.level.audit.AdminNoteLevel" />
			<param name="LevelMax" value="ADMIN_NOTE#com.oyster.mom.aspect.logging.level.audit.AdminNoteLevel" />
			<param name="AcceptOnMatch" value="true" />
		</filter>
	</appender>

	<appender name="MTMAUDIT-DISPLAY-ADMIN" class="org.apache.log4j.jdbcplus.JDBCAppender">
		<param name="dbclass" value="net.sourceforge.jtds.jdbc.Driver" />
		<param name="url" value="jdbc:jtds:sqlserver://db:1433/mtmaudit" />
		<param name="username" value="mtmuser" />
		<param name="password" value="medic1" />
		<param name="sql" value="INSERT INTO r3_display_admin_notes_audit(user_id, log_date, admin_info_text) values('@MDC:userId@', '@TIMESTAMP@', '@MDC:adminInfotext@')"/>
		<filter class="org.apache.log4j.varia.LevelRangeFilter">
			<param name="LevelMin" value="ADMIN_NOTE#com.oyster.mom.aspect.logging.level.audit.AdminNoteLevel" />
			<param name="LevelMax" value="ADMIN_NOTE#com.oyster.mom.aspect.logging.level.audit.AdminNoteLevel" />
			<param name="AcceptOnMatch" value="true" />
		</filter>
	</appender>

	<appender name="MTMAUDIT-DISPLAY-USER" class="org.apache.log4j.jdbcplus.JDBCAppender">
		<param name="dbclass" value="net.sourceforge.jtds.jdbc.Driver" />
		<param name="url" value="jdbc:jtds:sqlserver://db:1433/mtmaudit" />
		<param name="username" value="mtmuser" />
		<param name="password" value="medic1" />
		<param name="sql" value="INSERT INTO r3_display_user_audit(logon_date, user_id, org_code, organisation_description, user_name) values('@TIMESTAMP@', '@MDC:userId@', '@MDC:orgCode@', '@MDC:orgDesc@', '@MDC:userName@')"/>
		<filter class="org.apache.log4j.varia.LevelRangeFilter">
			<param name="LevelMin" value="USER_LOGIN#com.oyster.mom.aspect.logging.level.audit.UserLoginLevel" />
			<param name="LevelMax" value="USER_LOGIN#com.oyster.mom.aspect.logging.level.audit.UserLoginLevel" />
			<param name="AcceptOnMatch" value="true" />
		</filter>
	</appender>

	<appender name="USERBATCHLOG-MMS" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="File" value="<%= @logpath %>/user/user-mms.log"/>
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%d|%m%n"/>
		</layout>
		<filter class="org.apache.log4j.varia.LevelRangeFilter">
			<param name="LevelMin" value="USER_LOGIN#com.oyster.mom.aspect.logging.level.audit.UserLoginLevel" />
			<param name="LevelMax" value="USER_LOGIN#com.oyster.mom.aspect.logging.level.audit.UserLoginLevel" />
			<param name="AcceptOnMatch" value="true" />
		</filter>
	</appender>

	<appender name="MTMAUDIT-MMS-USER" class="org.apache.log4j.jdbcplus.JDBCAppender">
		<param name="dbclass" value="net.sourceforge.jtds.jdbc.Driver" />
		<param name="url" value="jdbc:jtds:sqlserver://db:1433/mtmaudit" />
		<param name="username" value="mtmuser" />
		<param name="password" value="medic1" />
		<param name="sql" value="INSERT INTO r3_mms_user_audit(logon_date, user_id, org_code, organisation_description, user_name) values('@TIMESTAMP@', '@MDC:userId@', '@MDC:orgCode@', '@MDC:orgDesc@', '@MDC:userName@')"/>
		<filter class="org.apache.log4j.varia.LevelRangeFilter">
			<param name="LevelMin" value="USER_LOGIN#com.oyster.mom.aspect.logging.level.audit.UserLoginLevel" />
			<param name="LevelMax" value="USER_LOGIN#com.oyster.mom.aspect.logging.level.audit.UserLoginLevel" />
			<param name="AcceptOnMatch" value="true" />
		</filter>
	</appender>

	<appender name="FILE_LOG" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="file" value="<%= @logpath %>/mapmanager/application.log" />
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<param name="encoding" value="utf-8" />
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern"
					value="%d %-5p (%F:%L) - %m%n" />
		</layout>
	</appender>
	
	<appender name="SEARCH_LOG" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="file" value="<%= @logpath %>/mapmanager/search.log" />
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<param name="encoding" value="utf-8" />
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern"
					value="%d %-5p (%F:%L) - %m%n" />
		</layout>
	</appender>
    
	<appender name="THESAURUS_LOG" class="org.apache.log4j.DailyRollingFileAppender">
		<param name="file" value="<%= @logpath %>/mapmanager/thesaurus.log" />
		<param name="DatePattern" value="'.'yyyy-MM-dd"/>
		<param name="encoding" value="utf-8" />
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern"
					value="%d %-5p (%F:%L) - %m%n" />
		</layout>
	</appender>

	<!-- ***********************************************************************
	Logger section - use the loggers to control logging according to message type
	and level.
	**************************************************************************-->
	
	<logger name="com.oyster.mom.service.SearchServiceImpl" additivity="false">
		<level value="debug" />
		<appender-ref ref="SEARCH_LOG" />
	</logger>
    
    <logger name="com.oyster.mom.search.translation.TranslationPreProcessor" additivity="false">
        <level value="INFO" />
        <appender-ref ref="SEARCH_LOG" />
    </logger>
	
    <logger name="com.oyster.mom.search.index.IpgIndexSearcherImpl" additivity="false">
        <level value="debug" />
        <appender-ref ref="SEARCH_LOG" />
    </logger>
    
	<logger name="com.oyster.mom.service.ThesaurusSearchServiceImpl" additivity="false">
		<level value="debug" />
		<appender-ref ref="THESAURUS_LOG" />
	</logger>

	<logger name="com.oyster.mom.contentserver" additivity="false">
		<level value="info" />
		<appender-ref ref="FILE_LOG" />
	</logger>
	
	<logger name="com.oyster.mom.mapmanager.action">
		<level value="info" />
		<appender-ref ref="AUDIT" />
	</logger>

	<logger name="com.oyster.mom.mapmanager" additivity="false">
		<level value="info" />
		<appender-ref ref="ERROR"/>
	</logger>

	<logger name="cs-exceptions" additivity="false">
		<level value="info" />
		<appender-ref ref="CS-EXCEPTIONS" />
		<!--<appender-ref ref="HPOV" />-->
	</logger>

	<logger name="cs-audit" additivity="false">
		<level value="info" />
		<appender-ref ref="CS-AUDITLOG" />
	</logger>

    <logger name="cs-job" additivity="false">
        <level value="info" />
        <appender-ref ref="CS-JOB" />
    </logger>

	<logger name="cs-security" additivity="false">
		<level value="info" />
		<appender-ref ref="CS-SECURITYLOG" />
	</logger>

	<logger name="java.exceptions" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="org.springframework.hibernate" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="org.springframework" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

    <!-- Logger added as advised by IST-6583 -->
    <logger name="org.apache.jackrabbit" additivity="false">
        <level value="warn" />
        <appender-ref ref="FILE_LOG" />
    </logger>

	<logger name="core" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="sitemap" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="handled-errors" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="access" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="flow" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="forms" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="startup" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="roles" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="instrument" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="values" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="manager" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="store" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="janitor" additivity="false">
		<level value="error" />
		<appender-ref ref="ERROR" />
	</logger>

	<logger name="exceptions" additivity="false">
		<level value="warn" />
		<appender-ref ref="EXCEPTIONS" />
		<!--<appender-ref ref="HPOV" />-->
	</logger>

	<logger name="front-end" additivity="false">
		<level value="debug" />
		<appender-ref ref="DEBUG" />
	</logger>

	<logger name="audit" additivity="false">
		<level value="info" />
<!-- 		<appender-ref ref="AUDITLOG" /> -->
	</logger>

	<logger name="security" additivity="false">
		<level value="info" />
<!-- 		<appender-ref ref="SECURITYLOG" />  -->
	</logger>
	
	<logger name="publication.messages" additivity="false">
		<level value="info" />
		<!--<appender-ref ref="HPOV" />-->
		<appender-ref ref="PUBLICATION_MESSAGES" />
	</logger>

	<root>
		<level value="error" />
		<appender-ref ref="ERROR" />
	</root>

</log4j:configuration>
